## 三、表单组件
### 1.button

>按钮

属性名 | 类型 | 默认值 | 说明 | 生效时机
- | - | - | - | -
size | String | default | 按钮的大小 | 
type | String | default | 按钮的样式类型 | 
plain | Boolean | false | 按钮是否镂空，背景色透明
disabled | Boolean | false | 是否禁用
loading | Boolean | false | 名称前是否带loading图标
form-type | String | | 用于\<form/>组件，点击分别会触发\<form/>组件的submit/reset事件 | |
hover-class | String | button-hover | 指定按钮按下去的样式类。当hover-class="none"时，没有点击态效果 | 
hover-stop-propagation | Boolean | false | 指定是否阻止本节点的祖先节点出现点击态 | 
hover-start-time | Number | 20 | 按住后多久出现点击态，单位毫秒 | 
hover-stay-time | Number | 70 | 手指松开后点击态保留时间，单位毫秒 | 
lang | String | en | 指定返回用户信息的语言，zh_CN简体中文，zh_TW繁体中文，en英文 | open-type="getUserInfo"
bindgetuserinfo | Handler | | 用户点击该按钮时，会返回获取到的用户信息，回调的detail的数据与wx.getUserInfo返回的一致 | open-type="getUserInfo"
session-from | String | 会话来源 | open-type="contact"
send-message-title | String | 当前标题 | 会话内消息卡片标题 | open-type="contact"
send-message-path | String | 当前分享路径 | 会话内消息卡片点击跳转小程序路径 | open-type="contact"
send-message-img | String | 截图 | 会话内消息卡片图片 | open-type="contact"
show-message-card | Boolean | false | 显示会话内消息卡片 | open-type="contact"
bindcontact | Handler | 客服消息回调 | open-type="contact"
bindgetphonenumber | Handler | 获取用户手机号回调 | open-type="getPhoneNumber"
app-parameter | String | 打开app时，向app传递的参数 | open-type="launchApp"
binderror | Handler | 当使用开放能力时，发生错误的回调 | open-type="launchApp"
bindopensetting | Handler | 在打开授权设置页后回调 | open-type=”openSetting“

- 注1：button-hover 默认为{background-color: rgba(0, 0, 0, 0.1); opacity: 0.7;}
- 注2：bindgetphonenumber 从1.2.0 开始支持，但是在1.5.3以下版本中无法使用wx.canIUse进行检测，建议使用基础库版本进行判断。
- 注3：在bindgetphonenumber等返回加密信息的回调中调用wx.login登录，可能会刷新登录态。此时服务器使用code换取的sessionKey不是加密时使用的sessionKey，导致解密失败，建议先提前进行login；或者在回调中先使用checkSession进行登录态检查，避免刷新登录态。
- 注4：从2.1.0起，button可作为原生组件的子节点嵌入，以便在原生组价上使用open-type的能力

**size有效值：**
值 | 说明
- | -
default | 默认大小
mini | 小尺寸

**type有效值：**
值 | 说明
- | -
primary | 绿色
default | 白色
warn | 红色

**form-type有效值：**
值 | 说明
- | -
submit | 提交表单
reset | 重置表单

**open-type有效值：**
值 | 说明
- | -
contact | 打开客服会话
share | 触发用户转发
getUserInfo | 获取用户信息，可以从bindgetuserinfo回调中获取到用户信息
getPhoneNumber | 获取用户手机号，可以从bindgetphonenumber回调中获取到用户信息
launchApp | 打开App，可以通过app-parameter属性设定向APP传的参数
openSetting | 打开授权设置页
feedback | 打开”意见反馈“页面，用户可提交反馈内容并上传日志，开发者可以登录小程序管理后台后进入左侧菜单”客服反馈“页面获取到反馈内容

```css
/** wxss **/
/** 修改button默认的点击态样式类**/
.button-hover {
  background-color: red;
}
/** 添加自定义button点击态样式类**/
.other-button-hover {
  background-color: blue;
}
```
```html
<button type="default" size="{{defaultSize}}" loading="{{loading}}" plain="{{plain}}"
		disabled="{{disabled}}" bindtap="default" hover-class="other-button-hover"> default </button>
<button type="primary" size="{{primarySize}}" loading="{{loading}}" plain="{{plain}}"
		disabled="{{disabled}}" bindtap="primary"> primary </button>
<button type="warn" size="{{warnSize}}" loading="{{loading}}" plain="{{plain}}"
		disabled="{{disabled}}" bindtap="warn"> warn </button>
<button bindtap="setDisabled">点击设置以上按钮disabled属性</button>
<button bindtap="setPlain">点击设置以上按钮plain属性</button>
<button bindtap="setLoading">点击设置以上按钮loading属性</button>
<button open-type="contact">进入客服会话</button>
<button open-type="getUserInfo" lang="zh_CN" bindgetuserinfo="onGotUserInfo">获取用户信息</button>
<button open-type="openSetting">打开授权设置页</button>
```
```javascript
var types=['default', 'primary', 'warn']
var pageObject = {
    data:{
        defaultSize: 'default',
        primarySize: 'default',
        warnSize: 'default',
        disabled: false,
        plain: false,
        loading: false
    },
    setDisabled:function(e) {
        this.setData({
            disabled: !this.data.disabled
        })
    },
    setPlain: function(e) {
        this.setData({
            plain: !this.data.plain
        })
    },
    setLoading: function(e) {
        this.setData({
            loading: !this.data.loading
        })
    },
    onGotUserInfo: function(e) {
        console.log(e.detail.errMsg)
        console.log(e.detail.userInfo)
        console.log(e.detail.rawData)
    },
}
for(var i = 0; i < types.length; ++i) {
    (function(type) {
        pageObject[type] = function(e) {
            var key = type + 'size'
            var changedData = {}
            changedData[key] = this.data[key] === 'default' ? 'mini' : 'default'
            this.setData(changedData)
        }
    })(types[i])
}
Page(pageObject)
```
**Bug & Tip**
- tip:目前，设置了form-type的button只会对当前组件中的form有效。因而，将button封装在自定义组件中，而form在自定义组件外，将会使这个button的form-type失效

### 2.checkbox

> checkbox-group，多项选择器，内部由多个checkbox组成

属性名 | 类型 | 默认值 | 说明
- | - | - | -
bindchange | EventHandle | | \<checkbox-group/>中选中项发生改变时触发change事件，detail={value:[选中的checkbox的value的数组]}

> checkbox，多选项目
属性名 | 类型 | 默认值 | 说明
value | String | | \<checkbox/>标识，选中时触发\<checkbox-group/>的change事件，并携带\<checkbox/>的value
disabled | Boolean | false | 是否禁用
checked | Boolean | false | 当前是否选中，可用来设置默认选中
color | Color | | checkbox的颜色，同css的color

```html
<checkbox-group bindchange="checkboxChange">
  <label class="checkbox" wx:for="{{items}}">
    <checkbox value="{{item.name}}" checked="{{item.checked}}"/>{{item.value}}
  </label>
</checkbox-group>
```
```javascript
Page({
  data: {
    items: [
      {name: 'USA', value: '美国'},
      {name: 'CHN', value: '中国', checked: 'true'},
      {name: 'BRA', value: '巴西'},
      {name: 'JPN', value: '日本'},
      {name: 'ENG', value: '英国'},
      {name: 'TUR', value: '法国'},
    ]
  },
  checkboxChange: function(e) {
    console.log('checkbox发生change事件，携带value值为：', e.detail.value)
  }
})
```

### 3.form

> 表单，将组件内的用户输入的\<switch/> \<input/> \<checkbox/> \<slider/> \<radio/> <picker/>提交

> 当点击\<form/>表单中formtype为submit的\<button/>组价时，会将表单组件中的value值进行提交，需要在表单组件中加上name来作为key。

属性名 | 类型 | 说明
- | - | -
report-submit | Boolean | 是否返回formId用于发送模板消息
bindsubmit | EventHandle | 携带form中的数据触发submit事件，event.detail={value:{'name':'value'},formId:''}
bindreset | EventHandle | 表单重置时会触发reset事件

```html
<form bindsubmit="formSubmit" bindreset="formReset">
  <view class="section section_gap">
    <view class="section__title">switch</view>
    <switch name="switch"/>
  </view>
  <view class="section section_gap">
    <view class="section__title">slider</view>
    <slider name="slider" show-value ></slider>
  </view>

  <view class="section">
    <view class="section__title">input</view>
    <input name="input" placeholder="please input here" />
  </view>
  <view class="section section_gap">
    <view class="section__title">radio</view>
    <radio-group name="radio-group">
      <label><radio value="radio1"/>radio1</label>
      <label><radio value="radio2"/>radio2</label>
    </radio-group>
  </view>
  <view class="section section_gap">
    <view class="section__title">checkbox</view>
    <checkbox-group name="checkbox">
      <label><checkbox value="checkbox1"/>checkbox1</label>
      <label><checkbox value="checkbox2"/>checkbox2</label>
    </checkbox-group>
  </view>
  <view class="btn-area">
    <button formType="submit">Submit</button>
    <button formType="reset">Reset</button>
  </view>
</form>
```
```javascript
Page({
  formSubmit: function(e) {
    console.log('form发生了submit事件，携带数据为：', e.detail.value)
  },
  formReset: function() {
    console.log('form发生了reset事件')
  }
})
```

### 4.input

> 输入框，该组件是原生组件，使用时要注意相关限制

属性名 | 类型 | 默认值 | 说明
- | - | - | - 
value | String | | 输入框的初始内容
type | String | 'text' | input的类型
password | Boolean | false | 是否是密码类型
placeholder | String | | 输入框为空时占位符
placeholder-style | String | | 指定 placeholder的样式
placeholder-class | String | 'input-placeholder' | 指定placeholder的样式类
disabled | Boolean | false | 是否禁用
maxlength | Number | 140 | 最大输入长度，设置为-1的时候不限制最大长度
cursor-spacing | Number | 0 | 指定光标与键盘的距离，单位px。取input距离底部的距离和cursor-spacing指定的距离的最小值作为光标与键盘的距离
auto-focus | Boolean | false | （即将废弃，直接使用focus就行）自动聚焦，拉起键盘
focus | Boolean | false | 获取焦点
confirm-type | String | 'done' | 设置键盘右下角按钮的文字，仅在type='text'时生效
confirm-hold | Boolean | false | 点击键盘右下角按钮时是否保持键盘不收起
cursor | Number | | 指定focus时的光标位置
selection-start | Number | -1 | 光标起始位置，自动聚焦时有效，需要与selection-end搭配使用
selection-end | Number | -1 | 光标结束位置，自动聚焦时有效，需要与selection-start搭配使用
adjust-position | Boolean | true | 键盘弹起时，是否自动上推页面
bindinput | EventHandle | | 键盘输入时触发，event.detail={value,cursor,keyCode},keyCode为键值，2.1.0起支持，处理函数可以直接return一个字符串，将替换输入框的内容
bindfoucs | EventHandle | | 输入框聚焦时触发，event.detail = {value,height},height为键盘高度，在基础库1.9.90 起支持
bindblur | EventHandle | | 输入框失去焦点时触发，event.detail={value:value}
bindconfirm | EventHandle | | 点击完成按钮时触发，event.detail={value:value}

> type 有效值

值 | 说明
- | -
text | 文本输入键盘
number | 数字输入键盘
idcard | 身份证输入键盘
digit | 带小数点的数字键盘

> confirm-type 有效值
值 | 说明
- | -
send | 右下角按钮为“发送”
search | 右下角按钮为"搜索“
next | y右下角按钮为”下一个“
go | 右下角按钮为”前往“
done | 右下角按钮为”完成“

**注意：**
confirm-type的最终表现与手机输入法本身的实现有关，部分安卓系统输入法和第三方输入法可能不支持或不完全支持。
```html
<!--input.wxml-->
<view class="section">
  <input placeholder="这是一个可以自动聚焦的input" auto-focus/>
</view>
<view class="section">
  <input placeholder="这个只有在按钮点击的时候才聚焦" focus="{{focus}}" />
  <view class="btn-area">
    <button bindtap="bindButtonTap">使得输入框获取焦点</button>
  </view>
</view>
<view class="section">
  <input  maxlength="10" placeholder="最大输入长度10" />
</view>
<view class="section">
  <view class="section__title">你输入的是：{{inputValue}}</view>
  <input  bindinput="bindKeyInput" placeholder="输入同步到view中"/>
</view>
<view class="section">
  <input  bindinput="bindReplaceInput" placeholder="连续的两个1会变成2" />
</view>
<view class="section">
  <input password type="number" />
</view>
<view class="section">
  <input password type="text" />
</view>
<view class="section">
  <input type="digit" placeholder="带小数点的数字键盘"/>
</view>
<view class="section">
  <input type="idcard" placeholder="身份证输入键盘" />
</view>
<view class="section">
  <input placeholder-style="color:red" placeholder="占位符字体是红色的" />
</view>
```
```javascript
//input.js
Page({
  data: {
    focus: false,
    inputValue: ''
  },
  bindButtonTap: function() {
    this.setData({
      focus: true
    })
  },
  bindKeyInput: function(e) {
    this.setData({
      inputValue: e.detail.value
    })
  },
  bindReplaceInput: function(e) {
    var value = e.detail.value
    var pos = e.detail.cursor
    if(pos != -1){
      //光标在中间
      var left = e.detail.value.slice(0,pos)
      //计算光标的位置
      pos = left.replace(/11/g,'2').length
    }
    //直接返回对象，可以对输入进行过滤处理，同时可以控制光标的位置
    return {
      value: value.replace(/11/g,'2'),
      cursor: pos
    }
    //或者直接返回字符串,光标在最后边
    //return value.replace(/11/g,'2'),
  }
})
```
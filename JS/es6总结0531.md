# Day26
## 十七、async函数
### 1.含义
  async函数就是Generator函数的语法糖，之前有一个依次读取两个文件的Generator函数：
```javascript
const fs = require('fs');
const readFile = function (fileName) {
  return new Promise(function (resolve, reject) {
    fs.readFile(fileName, function(error, data) {
      if (error) return reject(error);
      resolve(data);
    });
  });
};
const gen = function* () {
  const f1 = yield readFile('/etc/fstab');
  const f2 = yield readFile('/etc/shells');
  console.log(f1.toString());
  console.log(f2.toString());
};
```
  写成async函数，就是这样：
```javascript
const asyncReadFile=async function(){
    const f1=await readFile('/etc/fstab')
    const f2=await readFile('/etc/shells')
    console.log(f1.toString())
    console.log(f2.toString())
}
```
  async 函数就是将Generator函数的星号 替换成async，将 yield替换成await。async函数对Generator函数的改进，体现在四点：
  - 内置执行器
```javascript
  //Generator函数的执行必须依靠执行器，所以才有了co模块，而async函数自带执行器，也就是说,async函数的执行，与普通函数一模一样，只要一行
  asyncReadFIle()
  //这里调用了asyncReadFile函数，然后它就会自动执行，输出最后的结果，这完全不像Generator函数，需要调用next方法，或者用co模块，才能真正执行，得到最后的结果
```
  - 更好的语义
    async和await，比起星号和yield，语义要更清楚，async表示函数里有异步操作，await表示紧跟在后面的表达式需要等待结果
  - 更广的适用性
    co模块约定，yield命令后面只能是Thunk函数或Promise对象，而async函数的await命令后面，可以是Promise对象和原始类型的值（数值、字符串和布尔值， 但这时等同于同步操作）
  - 返回值是Promise
    async函数的返回值是Promise对象，这比Generator函数的返回值是Iterator对象方便多了，这样可以用then方法指定下一步的操作
  async函数 完全可以看做多个异步操作，包装成的一个Promise对象，而await命令就是内部then命令的语法糖。
### 2.基本用法
  async函数返回一个Promise对象，可以使用then方法添加回调函数，当函数执行的时候，一旦遇到await就会先返回，等到异步操作完成，再接着执行函数体后面的语句。
  举个栗子：
```javascript
async function getStockPriceByName(name){
    const symbol=await getStockSymbol(name)
    const stockPrice=await getStockPrice(symbol)
    return stockPrice
}
getStockPriceByName('goog').then(function (result){
    console.log(result)
})
//这是一个获取股票报价的函数，函数前面的async关键字，表明该函数内部有异步操作，调用该函数时，会立即返回一个Promise对象
```
  还有一个栗子，指定多少毫秒以后输出一个值：
```javascript

```

























